---
title: "Algoritma Linear Regression dengan R"
author: "Sifa'ul Kumairoh-Institut Teknologi Statistika dan Bisnis Muhammadiyah"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: flatly
    higlight: zenburn
    toc: true
    toc_float:
      collapsed: true
    df_print: paged
bibliography: references.bib
---

```{=html}
<style>
body{
text-align: justify}
</style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Algoritma Linear Regression
Machine learning merupakan ilmu yang mencakup bidang statistik, kecerdasan buatan, dan ilmu komputer. Machine learning dikenal juga sebagai analitik prediktif atau pembelajaran statistik (Muller and Guido 2017) - Supervised learning - unsupervised learning - semi-supervised learning - reinforement learning.

Regresi merupakan machine learning kategori supervised learning dengan target data berupa data numerik. Regresi banyak digunakan dalam berbagai area, seperti pendidikan, hukum, industri, bisnis, ramalan keuangan, pemodelan keuangan, perencanaan pasar, dan analisis tren (Mike Chapple, 2019). 
Regresi Linear merupakan salah satu metode yang biasanya digunakan untuk melakukan prediksi (menggunakan garis lurus) sehingga bisa dilihat dan bisa menggambarkan hubungan antara dua variabel atau lebih.

Dalam Algoritma Linear Regression terdapat 2 Model yaitu, Regresi linear sederhana (Simple Linear Regression) dan Regresi linear berganda (Multiple Linear Regression).

## Regresi linear sederhana (Simple linear regression)

Regresi linear sederhana adalah hubungan antara satu variabel dependen dengan satu variabel independent. Regresi linear sederhana juga digunakan untuk menguji sejauh mana hubungan sebab akibat antara variabel faktor penyebab (x) terhadap variabel akibat (y).
Faktor penyebab biasanya dilambangkan x (predictor), sedangkan variabel akibat dilambangkan y (response). 

Tujuan regresi linear sederhana adalah untuk mencari persamaan garis lurus yang sedekat mungkin dengan semua nilai yang ada, sehingga persamaan garis tersebut menjadi benar sebagai representasi dan bertujuan mengecek apakah ada hubungan yang signifikan atara variabel atau respons yang ada.

Persamaan regresi linear sederhana :

Y = β0 +β1.x1

Contoh Data set linear sederhana
```{r}
Y <- c (31,32,33,34,35,36,37,38, 39, 40, 41, 43)
X <- c (46, 45, 49, 58, 44, 63, 47, 61, 53, 53, 42, 68)
```
### Regresi linear berganda (Multiple linear regression) 

Regresi linear berganda adalah hubungan antara satu variabel dependen dengan dua atau lebih variabel independen. Tujuan umum dari regresi linear berganda adalah untuk mempelajari lebih lanjut tentang hubungan antara beberapa variabel independen (prediktor) dan variabel dependen (kriteria).
Bentuk persamaan regresinya adalah :

Y = β0+β0x1+β2x2+...+βnxn

Contoh Data set linear berganda
```{r}
Y <- c (43, 26, 39, 37, 33, 54, 27, 38, 36, 55, 44)
X1 <- c (66, 45, 47, 48, 57, 43, 65, 76, 61, 42, 67)
X2 <- c (8, 9, 32, 54, 22, 15, 15, 17, 6, 9, 11)
```

# Tahapan Algoritma Linear Regression
1. Menyiapkan data
2. Memprediksi pemodelan Machine Learning
3. Membandingkan hasil prediksi dengan data aktual
4. Evaluasi model

# Eksperimen Algoritma Linear Regression
Pada kasus kali ini, kita akan membahas regresi linear berganda menggunakan data Marketing. Data ini berisi jumlah uang yang dikeluarkan untuk iklan, pada tiga media pengiklan (youtube, facebook, dan newspaper) serta sales.

## Library
```{r}
library(datarium)
```

```{r}
data("marketing", package = "datarium")
head(marketing)
```

### Memprediksi Pemodelan dalam Machine Learning

Sebelum kita menerapkan metode machine learning, bagi dataset jadi dua kelompok:

1. Data pelatihan (train set) 60-75% 

2. Data uji (test set) 25-40%.

Pembagian data tersebut disebut sebagai cross validation. 
Data test merupakan data yang digunakan untuk melihat bagaimana kinerja model pada data baru atau digunakan sebagai data yang akan diprediksi, di mana nantinya kita akan membandingkan hasil prediksi dengan nilai sesungguhnya, kita akan mensample secara random index pada data marketing. 
75% data akan dijadikan sebagai data train, dan 25% data akan dijadikan sebagai data test. 
```{r}
set.seed(123)
idx <- sample(nrow(marketing),nrow(marketing)*0.75)
train <- marketing[idx,]
test <- marketing[-idx,]
```
Data train dan data test yang telah kita bagi
```{r}
head(train,3)
head(test,3)
```
Dari studi kasus diatas, kita akan mencari tahu apakah jumlah uang yang dikeluarkan pada iklan facebook berpengaruh terhadap penjualan (sales). Target variabelnya adalah Sales, dan untuk memprediksi target variabelnya kita menggunakan prediktor, yaitu Facebook. 

Membuat model regresi linear sederhana pada R
```{r}
model_simple <- lm(formula = sales~facebook, data = train)
```
Membuat visualisasi dalam bentuk grafik.
```{r}
plot(train$facebook, train$sales)
abline(model_simple, col = "red")
```

Kemudian, untuk melihat performa model, kita bisa cek dengan fungsi summary().
```{r}
summary(model_simple)
```
Pada summary dari model di atas, dihasilkan nilai multiple r-squared sebesar 0.3176.

Pada bagian koefisien, nilai estimasi untuk intercept (β0) adalah  11.4327. Selanjutnya masih pada bagian koefisien, untuk variabel Facebook nilai estimasi (β1) adalah  0.1942. 

Sehingga model regresinya :

Y = 11.4327 + 0.1942x1

Uji prediksi bisa menggunakan fungsi predict(). 
```{r}
pred <- predict(model_simple, test)
```
Setelah dilakukan prediksi, kita bisa membandingkan data aktual dengan hasil prediksi dari model yang telah kita buat sebelumnya
```{r}
library(dplyr)
```
```{r}
cbind(test, pred) %>%
  select(facebook, sales, pred)
```

#### Evaluasi Model

Untuk mengevaluasi kasus diatas kita perlu mencari eror dari data yang kita uji, dimana kita akan mencari RMSE nya. 
```{r}
library(MLmetrics)
```
```{r}
RMSE (pred, test$sales)
```
Jadi hasil output di atas, dapat kita simpulkan bahwa nilai RMSE yang dihasilkan sebesar 5.120427, dimana rata-rata nilai prediksi melenceng sebesar 5.120427 dari nilai aktualnya.

# Referensi

https://rpubs.com/delfitriani/851893

https://jagostat.com/R/regresi-linear-berganda-dalam-pemrograman-r

Arhami M & Nasir M., 2020, Data Mining Algoritma dan Implementasi

